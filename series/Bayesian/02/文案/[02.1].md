# 贝叶斯公式和世界观(1): 贝叶斯公式的推导、记忆、和变形 (精简版)
## p1
Hello各位同学大家好，我是fmajor,
我们首先开始第一个主题，
贝叶斯公式的
推导、记忆和变形。
这个视频我制作了两个版本，精简版和加长版
这两个视频，都是为了像大家介绍 后面几期视频中所需要用到的 概念和公式
如果想要快速进入后面那些相对有趣的章节，那么请观看精简版。
如果你本身对贝叶斯公式不是很熟悉，想要我更加耐心的对其进行讲解，那么请观看时长和内容 都超级加倍的 加长版视频。
你正在观看的为精简版。

还有，如果你是直接空降到此视频的话，请先观看第0期前言视频，传送门在这里。
那么我们开始吧
## p2
我们需要简单回顾一下 我推的贝叶斯-从零开始的贝叶斯推导 那期视频的内容。
我们之前 进行了 贝叶斯公理的引入 和贝叶斯体系中定理的推导，大致的逻辑就是（点）
首先提出了一个需求，尝试构建与人类直觉相符合的描述推理过的数学体系。
我们对这个需求进行了解构(点)，引入了 (点)若干公理，然后经过严谨的数学推导得出了(点)这5条定理。
而他们， 就是我们构建贝叶斯体系的开端。
我们这里还给出了概率在贝叶斯体系下的定义，一个定标过的，表示你对事件的感觉，或者说相信程度，再或者说，知识/认知和信念的，一个数值。
接下来，我们就基于这几条定理，来开始贝叶斯公式的推导。
## p3
万物起源，其实是乘法公式和加法公式。
对乘法公式，进行简单的移项操作，(点)我们就得到了贝叶 斯公式的原始形式。
这里的C，称之为先验知识，他是必须存在的，而且与使用贝叶斯公式的实体，例如人工智能推理模块，或者说一个人类，所绑定。
但是我们的推导过程中，因为所有的命题均在given C的语境下，所以我们在书写形式上可以对其进行简化(点)
得到贝叶斯公式的简化形式。

然后，贝叶斯公式的符号表示形式，不止一种。
其他常见的有，使用H，hypothesis, 假设，来代替A
使用E, Evidence，证据，来代替B
或者使用D, Data，数据/观测结果，来代替B
在我们后面的例子中，还会用到其他一些更直观的符号

在接下来的推导中，我们使用H假设和D数据来分别代替A和B，以取得一个更加直观的理解。
当然，这是我自己的习惯，这里的符号具体选什么不重要，只要方便你自身理解就可以了。(点)

然后就是对贝叶斯公式各部分进行理解的，一个经典的划分。
首先p(H)，我们称之为先验
p(H|D)，称之为后验，右边分子，称之为似然，分母部分，可以叫他Evience，证据，我自己有时候也叫他归一化因子。分子除以分布，是一个比值，可以把先验概率值 更新为 后延概率值，所以我们叫他，概率更新因子。这就是贝叶斯公式的基本形式。
# p4
然后，我们列举一些贝叶斯公式的常见形态和变换

这第一个形态我称之为记忆形态，因为我们知道，贝叶斯公式就是乘法公式稍微移一下项得到的。
而上面分子是乘法公式的一部分，分母乘以左边是乘法公式的另外一部分，而他们在形式上有非常好的对称性。
所以UP主从来不去记忆贝叶斯公式，每次都是现场推导，先对p(DH)进行乘法公式展开，得到这个p(H)先验概率，然后使用另外一种展开，把后验概率放左边，归一化因子放下面。
所以都是先写分子，再写分母和左边。书写速度和直接默写贝叶斯公式基本上是一样的，因为是一个非常简单的推导。所以大家只需要记忆乘法公式就可以了。（点）
然后就是第二个形态，我称之为先验更新形态。后验概率等于先验概率乘以概率更新因子。表示了在获得新数据D之后，我的先验概率，如何更新到后验概率。表示了一种更新的过程。（点）
接下来是很多考研的同学比较头痛的全概率展开形态。这个倒是也不难记，直接在记忆形态的基础上把归一化因子展开就行了，不过这里就需要用到加长版视频中 推导出来的互斥完备事件组的全概率公式（点）
然后接下来，二元展开形态，他其实是一种特殊的全概率展开形态，因为一个命题和他的否命题天然构成了互斥完备事件组，所以这个分母就变成了这样两项。（点）

最后，是我们接下来视频的重点。我称之二元事件的先验、灵敏度、特异性展开形态。
可以看到我们在二元展开形态的基础上，通过带入加法公式，使得公式中只包含了三种数值。
他们分别是p(H)先验概率，p(D|H)灵敏度，p(Dbar|hbar), 特异性。（点）
我们来仔细看一下他们的定义。
你可以暂时把假设变为患传染病，而数据变为检测结果为阳性
我们定义p(D|H)为灵敏度,sensitivity, 或者叫真阳性率。
而p(Dbar|Hbar)为特异性,specificity,或者叫真阴性率。
这个时候p(D|Hbar)就是1减去真阴性率，或者叫假阳性率，我们称这种条件，把不患病的人测为阳性，为第一类错误，或者说误诊
最后还有p(Dbar|H),就是1减去真阳性率，或者叫假阴性率，我们称这种条件，把患病的人测为阴性，为第二类错误，或者说漏诊

UP在第一次看到看到这四个值的定义和命名的时候，也是脑袋瓜嗡嗡的，记不住，特别是第一类和第二类错误，真假/阴阳 率，傻傻分不清楚。
但是我们视频之后的内容，会紧紧的围绕着灵敏度和特异性，进行展开和讨论。然后再结合一些非常具体的列子。
相信看到最后，大家应该能够自然而然的记住他们的定义。

对于二元事件，我们只需要知道先验、灵敏度和特异性，就可以计算后验概率，而且我们之后会发现，这种方法有他自己的优点。
# p5
然后，我们还需要介绍一下 概率的其他表示方法
首先是概率，probability，这个我们在前面的视频中已经明确的的定义过了。
他的取值范围是0到1，0代表事件A不可能发生，1代表事件A必然发生
然后我们可以对概率值进行一些数学变换，比如下一个，我们定义事件A的odds ratio为p(A)除以p(Abar),或者p除以1减p
这个odds ratio的翻译有很多种，根据其使用场景可以翻译为发生比，优势比，机会比，比值比，让步比等，同时他也在一些情况下表示赔率的倒数。
这里我们就称之为发生比吧。因为对于二值事件A来说，他就是事件A发生的概率除以它不发生的概率。
然后进一步的，我们对发生比取log，就得到evidence,这个单词也有很多种翻译的方法，直接翻译成证据的话，后面有一些表述说起来会怪怪的，所以我这里就翻译成证据量，来明确的表现出，他是一个数值。

使用证据量的一个好处，是 他与我们人类的感官系统 更加的匹配。
我们有一个韦伯-费希纳定理，他的大概意思是，人类的感觉方面的强度，和刺激强度的对数成正比，例如我们的听觉和视觉。
比如表示声音大小，我们就经常拿分贝作为单位，而分贝就是声压相对于参考值的一种对数表示方式。
而对于视觉，正是因为我们的感光设备对于光线强弱的响应是类对数的，才能让我们获得高动态范围的视力，亮的的地方和暗的地方可以同时看清楚。

（点）我们的证据量，可以直接使用10为底，那么他的单位就是dex。但是我们也可以使用更加常见的单位，分贝。
就是10倍log10的发生比。后面的数值例子中，我们也会一直使用分贝作为单位。

对于这三种等效的概率表示方法，我们举一些数值的例子会更加方便理解（点）
比如，概率50%，这个时候，发生比就是5比5，或者说55开，我们的证据量就是0，因为对于这件事情是否发生 没有偏好
而在概率百分之56的情况下，对应着证据量大约为1分贝，这个时候，我们才稍稍 偏信 一些，说A更有可能发生。
我这么说是因为，根据一些估计，一分贝大概是人耳所能分辨出的最小的声音变化幅度。
那我们也可以大致认为，一分贝的证据量变化，也是我们可以感知到的最小的证据量增量，也是我们开始产生偏信这一种感觉的证据量值。
而发生比2比1的情况下，对应着概率为百分之66.7,这个时候，我们的证据量大约有三分贝，我们已经有比较明显的偏信，更相信A要发生而不是A不发生
那如果把发生比倒过来一下，我们的证据量就会变成-3分贝，我们就比较明显的偏信A不发生。

接下来这三个例子，概率值从百分之70，两次增加百分之10%
但是这两次增加所带来的证据量的增量是不相同的，我们可以看到，概率从百分之80增加到百分之90，相比从百分之70增加到百分之80，是需要更多证据的
特别是对于小概率事件和大概率事件，概率接近于0或者接近于1，这个时候，新数据带来的概率值改变也许非常小, 我们对概率值本身的变化，已经没有清晰的概念了
就比如下面这几个例子，概率从百分之99增加到百分之99.9，尽管每次增加的概率值越来越小，但是增加的证据量却是越来越多
此时证据量的改变量才能更好的告诉我们，新数据给我们带来了多少有效的信息，我们之后的例子会对这个问题进行进一步的说明
# p6
最后，大家还需要了解贝叶斯因子的概念
我们之前说过，贝叶斯公式描述了，在拿到新数据之后，你对假设的概率认知，是如何更新的。其实就是先验概率乘以 概率更新因子 得到后验概率。
所以我们知道，如果概率更新因子大于一，那么后验概率将会大于先验概率，则新数据就支持假设H

既然概率更新因子是这个形式，那么发生比更新因子是什么样子呢？
其实发生比更新因子有另外一个名字，也叫做贝叶斯因子，既然都拿老先生的名字来命名了，想必也是一个 比较重要的数值。

（点）我们把它写出来，所谓更新因子就是后验除以先验，那么我们就写一个后验发生比除以先验发生比，得到这个形式
还记得前面ppt内容的同学会发现，这分子不就是灵敏度，而分母不就是1减去特异性么？对于特定的D与H，这两个值都是 常数，于是发生比更新因子就是一个 与先验先验概率无关的 常数。（点）
那么如果 连续得到独立的数据D_i，则后验发生比 就可以写成先验发生比乘以 数据各自的贝叶斯因子，的这种连乘的形式，非常的优雅。

特别是，（点）如果你对发生比更新的这个公式取log, 写成证据量更新的形式，则连乘就变成了求和，
这个公式，就代表了随着独立数据的获取，我的证据量是怎么样一点一点的变化的。
计算概率的变化，每次都需要带入前次一的先验概率，进性迭代的计算。
而计算证据量的变化时 就变成了 简单的加加减减，
而且数据固定的话，加减的数值都是一个常数，如果出现多个相同的数据，那么只需要加上 常数乘以重复数据个数 就可以了，不需像计算概率那样 反复迭代运算了，我们会在后面的具体例子中进一步体会到 这种计算上的便利性。

（点）然后，我们就拿一个最常见的例子，疾病检测，来简单的计算下，证据量的更新
在这里，为方便大家的理解，我再做一次符号替换，把假设H，替换为生病sick，把数据D替换为这个粗体的加号，代表疾病检测结果阳性
我们假设，检测对疾病的灵敏度，为95%，特异性，为90%，那么，第一类错误，误诊，假阳概率就是10%，第二类错误，漏诊，假阴的概率就是5%。（点）

我们来看一下，如果测得阳性和阴性结果，我们的概率和证据量是如何更新的。
概率更新需要计算 概率更新因子。我们需要把分母上的归一化因子展开，比较麻烦，没有办法快速计算，而且，更新因子和1的关系，也并不能一眼看出来。
但是，贝叶斯因子的计算，就要方便很多，口算都可以，他就等于灵敏度除以一减特异性。口算得，9.5，大于1，所以，阳性结果会患病的假设。
而同样的方法，计算阴性结果的贝叶斯因子，p(Hbar|dbar)的贝叶斯因子。得到18，也是大于一的，所以阴性的结果会支持不患病的假设。
阴性和阳性的结果，作为证据，其实是不对称，我们会在后面的具体数值例子中，对其进行进一步的说明。
# p7
刚刚的例子中，D对H是一个有效的检验手段。
为了检测S，我们寻找，或者说设计了的实验D, 使得实验的灵敏度和特异性都接近于1
灵敏度接近于1，我们是想要逼近 这个推导关系，想要实现，患者都为阳性，不漏诊
而特异性接近于1，我们是想要逼近 这一组推导关系，他们两个是等价的，互为逆否命题，想要实现，阳性者都是患者，不误诊
若能够实现，那么 患病者就等价于阳性者，这是我们所有的检测 想要达成的目标
但是，现实是，灵敏度和特异性 都是小于1的，我们必定 会犯第一和第二类错误，造成误诊和漏诊，不过只要错误率 在我们可以接受的范围内就可以了。
那么这么这两个错误率 会多大程度上 影响我们认知的更新呢？（点）
我们把这两个贝叶斯因子都给写出来。一个是测得阳，我对生病的 发生比更新。另外一个是测得阴，我对不生病的 发生比更新。
我们看这两个数值 都只跟灵敏度和特异性有关。
对于正常的、我们选出来的检测手段，两者都应该接近1，于是两个贝叶斯因子都应该大于1或者远大于1。
我们说这个检测方法是有效的。（点）

然后我们再来讨论一下 下面的这些特殊情况
灵敏度+特异性等于2，或者说，两者都等于1，这个就是等价关系。两者就是一回事儿
那么灵敏度+特异性等于1呢？这个时候，我们发现两个贝叶斯因子都为1，此时检测是不提供任何信息的，具体的例子我们后面再说。
第三种就更有意思了，灵敏度+特异性<1，这个时候，两个贝叶斯因子都是小于1的。
你拿到数据之后，它甚至给你提供的是反向的信息，不过数据会对逆假设提供正向的信息。关于这个的具体例子，我们也放在后面再说。

# p8
好啦，关于灵敏度、特异性，概率更新因子和贝叶斯因子的 概念和简单实例，我们就介绍到这里。
接下来，我们会使用很多例子，来帮助大家消化和理解 之前的内容。
如果你觉得本期视频节奏有点快，想要再仔细学习和记忆其中内容的话，可以选择去观看加长版的视频，其中的内容会更丰富，燕国地图会徐徐展开。
不过，我还是更加建议，大家先看完后面几期视频，从具体的例子中获得对贝叶斯体系的 一个 全面的、更高层次的认知。然后再评估，是否需要再仔细学习公式的推导过程。

我们下一个视频见。