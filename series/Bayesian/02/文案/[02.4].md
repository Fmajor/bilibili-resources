# 贝叶斯公式和世界观(4): 相关和因果关系初探
## p1
Hello各位同学大家好，我是Fmajor。最后，我们来探讨一个全新的话题，相关和因果关系初探。
因果推断，是UP主最近才开始学习的一门新的学科，他的内容很丰富，展开来就是一门完整的课程。
今天我们，只会结合之前视频中的内容，来简单的讨论一下。
直接空降到此视频的同学 请 先观看 前面四期视频，传送门在这里。

话不多说，我们正式开始。
## p2
之前的内容，无论是频率派还是贝叶斯派，我们讨论的都是 概率。而概率其实是代表了一种相关关系。
在现在，只要是系统学习过概率课程的，你一定会听到你的老师，这样啰嗦过。
(老学究声线)同学们，一定要记住啊。相关不代表因果。千万不要把相关关系认为是因果关系，从而闹笑话啊。

这也的确成为了如同教条一般存在的观念，让我们在关于数学和科学的讨论中，不敢轻易的说出 因果关系 这四个大字。
仿佛一旦这么说，周围就会充满了快活的空气，你就会闹笑话，而你的统计学老师，就会瞪大眼睛望着你，仿佛再说，你这是禁忌、异端思想。

（点）当然，很多情况下，相关的确不是因果，我们保持这种谨慎是没有问题的。
但是，又有很多时候，相关 的确就是 因果关系造成的啊。如果我们死守上面的教条，可能就会错过一些事情。
我们来举一个反例吧。
(插入视频: 理科生坠入情网，故尝试证明,S01E11 20:37~21:39)

（点）虽然 这只是非常经典的戏剧处理手法，但是他所基于的理论 却令我们眼前一黑，
相关不代表因果，这句话，真的就像思想钢印一般，刻在了所有理科生脑中了。

(点)事实上，因果这个词汇，在统计学诞生之后，在科学界中，被禁用了很长的事件。
一些因果分析的先驱科学家们，例如休厄尔·赖特，在他们那个年代，尽管以及几乎完成了和现代因果分析理论十分接近的成果，
但是，他们的成果和思想，却受到当时统计学权威的批判，压制和贬损。
（点）关于因果推断理论发展历史中的 恩怨纠葛，我推荐大家去阅读Judea pearl所写的科普读物，The book of why，中文译名 为什么。
这本书也特别适合作为 因果推断理论学习的 入门书籍。
在大概过去三十年中，因果推断理论 快速发展，被越来越的人 所接受和应用。
很多人都称这个过程为，因果革命，他为统计学带来了新的维度
现代因果科学，所研究的内容，包括 了解因果机制，追溯 造成结果的原因，还有 衡量原因 对结果的作用大小等
他使得，我们过去那种，以数据为中心范式的研究方法:拟合数据 ，进化为另外一种科学主义范式，叫做理解数据。
具体他是怎么做到的，up主也在理解和学习中。

对于社会学、医学、复杂科学等领域，那些很多现象的成因 特别复杂的情形，因果关系的分析 是尤其重要的。
作为21世纪20年代的新一代理科生，除了概率论，因果推断理论也应该 加入你的技能树之中了。
教条已经被打破，对于很多问题，我们都能够有更加合理的认知了。

因果推断理论是基于概率论的，特别是贝叶斯理论。或者说，他就是贝叶斯理论的一种更高级别的应用。
因为他是一门完整的学科，其内容非常的丰富。我们今天这里只是，相关关系与因果关系初探，啊，初探。
更深入的内容，请大家自行搜索其他的专题教学资料吧。

相关不代表因果，但是很多的相关，的确就是因果造成的。（点）
所以我们想要讨论一下，相关关系与因果关系，到底是什么。

首先说相关，熟悉频率派 统计知识的同学们，第一反应，应该是相关系数
就是 皮尔逊相关系数，能够表示两个随机变量的线性相关程度
而我们想要说的 其实是另外一个定义，就是条件概率定义。
我们之前已经定义了，两个事件独立，意味着 一个事件的取值 不影响另外一个事件的取值。
而不独立，不满足这个条件概率的等式，就意味着相关。
然后是因果关系。它存在一个结构因果模型，我们在下一页给出具体描述，这里就简化一下。
简单来说，因果之间存在函数关系，但因变会导致果变，反之则不对
因的一些取值，会导致果的一些取值。我们可以放心的使用造成、导致、得出等这些 在传统统计学中 被禁止使用的动词，来描述因和果的关系。
我们接下来，简单的讨论一下，这四种情况。其中要着重讨论的是，在两者相关的基础上，是否存在因果关系。或者，相关关系是否由因果关系而导致。
## p3
我们来更加详细的了解一下结构因果模型。
一对儿因果关系 由三个集合定义。
首先是 外生变量集合U，就是那些我们知道 他们在变化，但是不需要解释 他们变化原因的那些因素。
然后是 内生变量集合V，就是我们模型所关注的，需要解释 他们变化原因的那些因素。
函数集合f，就是一组关于UV变量的函数。而能够写出函数表达式，就代表其中的变量们，是有数值关联的。
我们看，X可以由其他变量，计算而得出。
而因果的定义就是，若Y存在于𝑓_𝑋的定义域中，则变量Y是变量X的直接原因。
然后，原因的定义是一个基于直接原因的，递归的一个定义。

这个完整的定义其实是有点绕口的，有的同学说，那我简化一下，就是因果之间存在函数关系呗，一句话就搞定了吧
但是这样简化是不对，函数关系是两个方向的关系，你稍微移一下项，自变量和因变量就可以进行交换，辈分就乱了，别忘了因果是有方向的。
因变会导致果变，反之则不对。大家在仔细琢磨一下这个完整的描述吧

大家一看数学定义就头晕，我们就直接举一个例子。（点）
比如我想知道，A学习成绩差，C家庭教育差和B沉迷游戏，三者之间的因果关系
假设, 经过一顿数据分析，我找到了这个关系，于是就按照结构因果模型的要求，给出了他们之间的因果定义。

首先是 内生变量集合V，就是我们模型所关注那些因素。那就是学习成绩差,家庭教育差和沉迷游戏
然后是 外生变量集合U，每一个内生变量都至少受一个外生变量的影响，
比如和学习成绩差 有关的外生变量，我们认为可以有，智商低, 情商低和其他
跟沉迷游戏有关的外生变量，可以有 学校环境差,社区环境差，被其他同学给带坏了。还有其他
最后 家庭教育差，外生变量有可能是 父母学历低，父母工作忙
最后，他们之间的关系，有可能是这样子的。
学习成绩差，由智商低主导，受家庭教育差影响比较大，而沉迷游戏有一点贡献，但不多。
然后这里的其他，是更多的 未知的因素，其贡献可能是正的 也可能是负的
沉迷游戏，我们认为，孩子可能是因为 受同学和其他伙伴的影响而这么做，但是分析了数据之后，
我们发现，家庭教育差，也许对这个行为，贡献了更多
最后，家庭教育差，可能是受到了父母学历和工作情况影响

这么分析之后，我们就得到了，所有这些变量的因果关系了，大概是这个样子的
家庭教育差，会直接导致，学习成绩差和沉迷游戏，而沉迷游戏，也会造成学习成绩差。
这就是因果图，一个有向无环图，来描述因果关系

这里的因果关系，是我随便编的，大家不用深究他对不对
主要是为了让大家了解 一个因果关系中的各种要素。
内生变量、外生变量和他们之间的函数关系。
函数关系定了之后，我们分别把不同的内生和外生变量带入X和Y，然后考察在这些关于X的映射中，Y是否存在于𝑓_𝑋的定义域中,
如果满足，那么变量Y是变量X的直接原因，我们就可以画一条箭头，从Y到X。表示他们之间存在因果关系。

这就是因果图和因果关系的定义。
我们接下来讨论，因果关系和相关关系。(点)

首先看一组最平凡的关系。因果图和结构因果模型是这样子的。
我们可以看到，所有内生变量，他们的取值，仅仅由一些对应的外生变量决定。
也就是说取值不受其他内生变量的影响。所以彼此之间也没有相关关系。
这里ABC是,无因果关系，无相关关系，相互独立的，一种最平凡的关系。（点）

另外还有一种比较特殊的情形。有因果关系，却无相关关系。这里有一个比较复杂的例子。大家可以暂停下来仔细琢磨他们之间的关系。
这个例子造成的结果是，无论U_𝑌和U_𝑍取什么值，X都对Z值没有任何影响，所以他们的取值是独立的，不相关的。虽然说，按照定义，X是Z的原因。
这种情况大家基本可以忽略，只是作为对数学讨论严谨性的补充，真实世界中很难遇到这种例子。
## p4
其实我们主要想讨论的是，在两者有相关关系的情况下，他们的相关关系，是否是由因果关系造成的。
我们来考察ABC三个事件，给出因果推断中，最基本的三种因果结构。（点）
首先给出他们的因果图。然后来分析一下他们的相关关系。
这三种结构，分别被称为，链式结构，叉结构和对撞结构。主要区别是他们的因果方向。
链式结构中，C在AB之间，称之为中介因子。
叉结构中，C是A和B共同的原因，称之为共因，或者混杂因子。
而在对撞结构中，C是A和B共同的结果，称之为对撞因子。

我们来仔细分析一下，A和B，在这三个结构下的因果关系和相关关系。
对于链式结构，A是B的直接原因的直接原因，所以是他的原因。
A和B有因果关系。A的取值会影响到B的值，所以他们有相关关系。而且这种相关关系是因果的。（点）
具体的例子可以是： A 是一个学生收到资助，C 是学生的成绩比较好，B 是学生被大学录取。
AC和CB之间都具有因果和相关关系，所以，AB之间也有。
还有核酸检测的例子，我们后面再说。
当然，因果链也可以很长。我就不举其他例子了。
对于链式结构来说，有一点比较重要，就是我们一定不能限制C的取值，或者说使用控制变量法控制住C。
具体操作，就比如，我收集到了很多同学ABC的信息，如果我直接分析数据中 A和B的相关系数，我发现A和B是正相关的。
但是，如果我对C的取值有了任何的限制，例如只挑出了成绩好，或者成绩差的那些同学。
这个时候再分析A和B的相关性，我们发现A和B就无关了。
控制C的取值，会切断，A和B之间的信息传递，使得他们丧失了相关性。
所以链式结构，在中介因子没有被控制的情况下。A和B是有相关性和间接因果的。

然后我们来看叉结构。C是A和B的共因。
我们直接举例子。天气变热，会同时增加犯罪率和冰激凌销量。
这个时候，如果你直接分析 犯罪率和冰激凌销量的关系，你会发现，他们是正相关的。
但是这种相关性是 非因果的。你不能通过关闭冰激凌店来减小犯罪率。也不能通过更多的治安巡逻，来增加冰激凌销量。
这就是我们常说的 伪相关。但是这个伪相关，还真是有相关关系，只不过相关是非因果的。
那么怎么去除掉伪相关的影响呢？这个时候，控制变量法就很有效了。
我们选取一年中，平均气温相近的那些天，控制住天气变量。筛选出来数据。
然后对于选出来的A和B进行相关分析。这个时候，A和B之间的那种虚假的相关关系就会消失了。
还有其他的例子，比如对于一个小孩儿，我们发现，他的阅读能力 和他穿的鞋子尺码是正相关的。
那么我们能不能通过 让他穿更大的鞋子 来提升他的阅读能力呢？显然是不可以的，因为还有一个孩子年龄，作为混杂因子，为A和B，提供了，额外的相关关系。
或者看下一个例子，某标题党自媒体说，经过统计研究，40岁以下的人，结婚的人，收入更高，所以，大家赶紧结婚吧，收入就能提高了
其实还是因为，年龄，作为收入和结婚的共因，为他们提供了，额外的正相关性。
最后我们还来看，沉迷游戏和学习成绩差。（点）这个例子中，A和B之间，其实，是有一根箭头的。
沉迷游戏，肯定会造成学习时间变短，从而学习成绩变差。他们之间的因果关系，是毋庸质疑。
但是，因果关系，是一个定量的关系。我们有一个因果强度的说法。
考虑到 家庭教育因素，作为沉迷游戏 和学习成绩差的共因。
A和B之间的正相关关系，一部分是由C的存在提供的，而另外一部分是由A和B的因果关系提供的。
那么怎么区分这两者的贡献呢？控制住变量C，就可以去除掉由他带来的为相关。然后A和B剩下来的相关性，就是他们之间的直接因果效应造成的。（点）

这就是叉结构的例子和应用，在一个不受控制的混杂因子C的存在下，A和B之间，有虚假的相关性，但是，他们之间，可能是没有因果的。

最后一个对撞结构，更加有意思，他是很多，神奇现象的来源。
C是A和B的共同结果。如果，我们有意 或者无意的把C给控制住，就会造成，A和B之间，虚假的相关性。
例如在一所高校中，音乐成绩好，或者文化课成绩好，都能获得奖学金。
那么在颁奖典礼上，你会发现，上台的人，要么 音乐成绩好，要么 文化课成绩好。这两种特性，竟然具有了负相关的关系。
但是如果我们在校园中 随机抽样，不限制抽样的人是否获得了奖学金。那么A和B的相关性 就不存在了。
其他的例子，我们来看，更有意思。电视节目中的知名演员，要么颜值高，要么演技好，仿佛这两个特性是水火不相容的。
这是由于控制了对撞因子，而造成的伪相关，有时会称之为辩解效应。
这种结构所造成的神奇现象，其实有很多名字和例子。（点）
比如所谓的幸存者偏差。这是二战中某部队返程飞机的受损示意图。我们发现，他受损的位置和飞机的关键重要位置。竟然也是负相关的。
那么我们应该加固哪里呢？是这些看起来受到伤害更多的位置么？肯定不是吧。这就是幸存者偏差带来的影响。
此外还有其他一些例子，比如尤尔-辛普森悖论，和三门问题。他们都是对撞结构的结果。两者都需要一些篇幅来解释，这里我就略过了，大家可以把他当做课后作业，在评论区中进行解答和讨论。（点）

所以这是最后一个结构，在控制住了一个对撞因子之后，没有因果关系的两个变量，却具有了相关性。
所以，控制变量法，我们不能乱用，否则就有可能造成这种人为是生成的 伪相关。

这三个就是因果推断中的所有基础结构，更复杂的因果结构，都是这三者的组合和堆叠。
更复杂的因果推断课程，请大家自行搜索相关的内容吧。B站上已经有很多了。
## p5
这是我们视频最后一个课题了。
灵敏度、特异性与因果关系

我们前面，花了很大的篇幅，来讨论基于灵敏度、特异性的二值信念更新模型。
而且，我们也尝试探索了，提高灵敏度和特异性的方式。
在不了解因果关系的前提下，我们只能 组合一下手头已经有的那些数据，来尝试提高灵敏度，或者特异性，但代价是，牺牲另外一个性质。
但是，在已知因果关系的前提下，我们就能，更有针对性，选择、构建、试验方法，或者数据，来提高灵敏度和特异性。

好，我们现在站在因果关系的角度，来重新审视一下灵敏度和特异性。
所谓灵敏度高，就是，因 更有可能造成果。而灵敏度最高的情况，就是 因 一定能造成果。
然后特异性：就是，果 更多的是由因造成的，特异性嘛，是吧，这个翻译还是很贴切的。
而特异性最高的情况就是，果 仅仅由因造成。（点）

我们随便画一个A和B的因果图。A到B有一条直接因果路径，和几条间接因果路径。
我们首先来探索一下，如何增加灵敏度。（点）
首先，最直接的，就是增加他们之间的 因果强度。这个相当于 直接 想办法 提高条件概率。
或者我们可以尝试，减小，间接因果的 链路长度，因为你每过一个中介变量，你都需要乘以一个 小于1的条件概率。
链路越长，你最终传递过去的影响，就会连乘式的降低。
或者，我们可以尝试增加因到果的链路数量。就比如，之前提到过的OR方法，我把A+C,作为新的因。那么因到果之间的因果路径条数 就增加了一条。
我们就实现了因更加有可能造成果，这样一个目的。从而提升了灵敏度。

然后再来看特异性。如果我们的果，是一种检测结果，比如医疗化验，那么我们希望得到的结果，是一个比较纯粹，比较干净的结果。
他最好 只受因的影响，而不受其他因素的影响，这样才叫特异性高。
我们看图中的B,他除了受到 A的直接因果影响之外，还受到UB这些外生变量的影响，而且还有，由其他因果路径，所引入的，UM，这些外生变量的影响。
那么，怎么提高特异性呢?
首先可以尝试控制，或者减少，那些与因无关的，因果链路数量，把这些UB的影响都给控制住，或者去掉。那特异性不就高了么。
或者，就可以尝试缩短，间接因果路径的长度。因为你每多一层中介变量，都会引入额外的外生变量，造成对B的间接影响。除非你能控制住这些外生变量，否则，因果链长度还是越短越好。
或者还可以尝试减少(与因有关)因果链路数目，比如我把这两条跟A有关的因果路径都给砍了。那么一下子就清除掉了很多外生变量的影响。
不过 代价是灵敏度会下降。另外，采用and方式要求A和C同时成立，因果路径才有效，也相当于等效的，减少了(与因有关)因果链路数目。
我能想到的，大概就是这么多了。（点）
这部分内容，完全是UP主，在写文案的时候，自己琢磨出来的，我没有在任何教科书上看到过类似的说法。所以这里讲的东西，有可能会有一些问题。
如果大家有自己的想法，请一定在评论区进行分享，我们共同探索和打磨，关于这部分的内容。

好，这就是我自己琢磨出来的，基于因果关系视角的，改善灵敏度和特异性的方法论。
可以看到，关于因果链路数目的改变，两者是有相反效果的，正如我们之前说过的，and和or方法。
而减小间接因果链路长度，可以同时增加灵敏度和特异性。
增加直接 或者间接因果强度，可以单方面提高灵敏度而不牺牲特异性。
而减少(与因无关) 因果链路数目，可以单方面提高特异性而不牺牲灵敏度。
如果大家还有发现 其他的方法论，欢迎补充。

我们之前还提到过，如果想要找到或者构造一个，高灵敏度，高特异性的检测方法，那么就必须从底层原理和因果关系入手。（点）
就让我们用 核酸方法检测新冠病毒的 因果图例子，来完成这最后的讨论把。

H是假设，新冠感染，我们的数据是阳性。他们是一个间接的因果关系。我们来一个一个看其中的中介因子。
新冠感染发病期，你的身体中会存在大量病毒，作为结果，鼻拭子和咽拭子采样中就会存在病毒。
当然，这个结果也有可能是你的样品被其他阳性患者所污染而造成的，还有其他可能的操作、存储、运输不规范，等因素，都会影响M1结果，这是M1引入的外生变量。接下来，M2是核酸提取，他是由M1造成的，两者是直接因果关系。
然后M3对核酸进行扩增，你有M2的核酸，你M3才能扩增成功
M4是在M3的基础上，使用核酸探针，产生可探测的(荧光)信号，M5使用仪器检测信号，分析信号强度，最后得到阳性结果。
整个流程由直接因果关系相连，且每一对儿因果关系的强度都非常高，所以，尽管逻辑链比较长，他的灵敏度也会非常高。
而对于特异性，即使在最后一步，也有可能出现，医务人员手抖了，把阴性录入为阳性，这种结果的可能行。
所以，对于特异性的把握，我们是通过各种规章制度、标准操作流程SOP、检测人员的日常训练、试剂厂家的质保质检，等等手段，来控制所有这些，外生变量。
于是特异性就有了保证。我们最终，从理化生各个学科的科学知识，得到了这样的因果图，控制外生变量，实现了核酸检测这一种，高灵敏度，高特异性的检测手段。
## p6
最后我们来收个尾。
之前的视频，我们主要在讨论贝叶斯世界观，所谓的万事万物皆分布。
这其实是很多科学家的工作范式。使用数据，拟合数据，从而得到，基于某个模型的，模型参数后验分布。
但是，模型从哪里来呢？其实有很多模型，就是在进行因果推断之后得到的。

创造新模型，和进行模型拟合是两件事情。
两者侧重点不同，但都很重要，缺一不可。
所以，很多的科学论文。在完成了模型拟合，提供了新的后验分布之后。也会尝试进行一些因果关系的讨论。
看看我们的模型本身有没有改进的空间。而在因果革命完成之后的现代社会，我们希望，文章中关于因果关系分析的篇幅可以更多一些。
使得我们可以更好的理解数据。

因果推断，是基于贝叶斯体系的，对其更加高级的一个应用。
在模型固定的情况下，我们对世界认知的更新，还是依赖于贝叶斯公式的，贝叶斯的世界观，还是值得我们去信赖的。
## p7
以上就是关于贝叶斯公式和贝叶斯世界观，的所有内容了。

第一个视频中，我们主要进行了很多的公式推导，了解了贝叶斯公式的常见变形，并充分讨论了基于灵敏度和特异性的二值事件概率更新模型。
第二个视频中，我们举了这样一些，或经典，或新潮的例子。意识到了二值事件概率更新模型，在我们日常认知和推理过程中的广泛应用。
在第三个视频中，我们深入讨论了，频率学派 和 贝叶斯学派的区别。

使用非常多的例子，向大家传达了，贝叶斯主义 世界观和信仰： 万事万物皆分布

然后，本期视频，我们简单介绍了相关关系与因果关系，给出了 灵敏度、特异性与因果关系 之间的关联。
最后，还讨论了，因果推断与贝叶斯理论，对于科学认知的贡献。
因果推断理论可以帮助我们更新或者创造新模型，而在模型固定的情况下，(bmg渐入)我们还是在使用贝叶斯方法论，来更新对于这个世界的认知。
## p8
送大家一副不怎么对仗的对联儿，来总结这4期视频的内容。

上联：灵敏特异辨真伪，下联：万事万物皆分布，横批：贝叶斯派。

这就是视频的全部内容了。
谢谢大家的收看。如果你觉得我讲的还不错的话，请将第零集视频分享给身边的同学们。
我希望有更多的人，了解贝叶斯的世界观，这是我做这一系列视频的初衷。
也是我拖更了10年的一个愿望。

那我们之后的视频再见。
## p9
(参考资料)
## p10
(致谢)
(bgm完)